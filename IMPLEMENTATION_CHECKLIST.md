# Flutter POSアプリ実装手順書（チェックリスト付き）

## プロジェクト概要
- **目標**: Next.js版POSアプリをFlutterで再実装
- **段階的実装**: 基本機能 → バックエンド接続 → バーコードスキャン機能
- **開発管理**: Git による細かなバージョン管理

## フェーズ1: プロジェクト基盤構築

### 1.1 プロジェクトセットアップ
- [ ] Flutterプロジェクトの作成
- [ ] 必要なパッケージの追加（pubspec.yaml）
- [ ] 基本的なディレクトリ構成の作成
- [ ] 初期コミット（プロジェクト基盤）

### 1.2 データモデル定義
- [ ] `lib/models/product.dart` - 商品データモデル
- [ ] `lib/models/purchase_item.dart` - 購入商品データモデル
- [ ] `lib/models/transaction.dart` - 取引データモデル
- [ ] コミット（データモデル定義）

### 1.3 設定・定数ファイル
- [ ] `lib/config/app_config.dart` - アプリ設定
- [ ] `lib/utils/constants.dart` - 定数定義
- [ ] コミット（設定・定数ファイル）

## フェーズ2: 基本UI実装

### 2.1 テーマ・スタイル設定
- [ ] `lib/main.dart` - アプリエントリポイント
- [ ] Material Design 3 テーマ設定
- [ ] カスタムカラーパレット定義
- [ ] コミット（テーマ設定）

### 2.2 メインPOS画面の基本構造
- [ ] `lib/screens/pos_screen.dart` - メインPOS画面
- [ ] 基本的なレイアウト構造
- [ ] 商品検索入力フィールド
- [ ] コミット（メインPOS画面基本構造）

### 2.3 商品検索ウィジェット
- [ ] `lib/widgets/product_search_widget.dart` - 商品検索ウィジェット
- [ ] 商品コード入力フィールド
- [ ] 検索ボタン
- [ ] 商品情報表示エリア
- [ ] コミット（商品検索ウィジェット）

### 2.4 購入リストウィジェット
- [ ] `lib/widgets/purchase_list_widget.dart` - 購入リストウィジェット
- [ ] 商品リスト表示
- [ ] 数量調整ボタン
- [ ] 商品削除ボタン
- [ ] 合計金額表示
- [ ] コミット（購入リストウィジェット）

### 2.5 共通ウィジェット
- [ ] `lib/widgets/custom_button.dart` - カスタムボタン
- [ ] `lib/widgets/loading_indicator.dart` - ローディングインジケーター
- [ ] `lib/widgets/error_dialog.dart` - エラーダイアログ
- [ ] コミット（共通ウィジェット）

## フェーズ3: 状態管理実装

### 3.1 Provider セットアップ
- [ ] `lib/providers/pos_provider.dart` - POSアプリの状態管理
- [ ] 商品検索状態の定義
- [ ] 購入リスト状態の定義
- [ ] エラー・ローディング状態の定義
- [ ] コミット（状態管理基盤）

### 3.2 状態管理ロジック
- [ ] 商品検索ロジック（モック実装）
- [ ] 購入リスト操作ロジック
- [ ] 数量調整ロジック
- [ ] 商品削除ロジック
- [ ] 合計金額計算ロジック
- [ ] コミット（状態管理ロジック）

### 3.3 UI と状態管理の連携
- [ ] POS画面でのProvider利用
- [ ] 商品検索ウィジェットでの状態連携
- [ ] 購入リストウィジェットでの状態連携
- [ ] コミット（UI状態管理連携）

## フェーズ4: モック実装での動作確認

### 4.1 モックデータ作成
- [ ] `lib/data/mock_products.dart` - モック商品データ
- [ ] 商品検索のモック実装
- [ ] 購入処理のモック実装
- [ ] コミット（モック実装）

### 4.2 動作確認
- [ ] アプリケーションの起動確認
- [ ] 商品検索機能の動作確認
- [ ] 購入リスト操作の動作確認
- [ ] 数量調整機能の動作確認
- [ ] 商品削除機能の動作確認
- [ ] 合計金額計算の動作確認
- [ ] コミット（基本機能動作確認）

## フェーズ5: バックエンドAPI連携

### 5.1 HTTP通信サービス
- [ ] `lib/services/api_service.dart` - API通信サービス
- [ ] HTTP Client の設定
- [ ] API エンドポイントの定義
- [ ] エラーハンドリング
- [ ] コミット（API通信サービス）

### 5.2 商品検索API連携
- [ ] `GET /products/{code}` の実装
- [ ] 商品検索のAPI連携
- [ ] エラーレスポンス処理
- [ ] 「商品がマスタ未登録です」対応
- [ ] コミット（商品検索API連携）

### 5.3 購入処理API連携
- [ ] `POST /purchase` の実装
- [ ] 購入データの送信
- [ ] レスポンス処理
- [ ] エラーハンドリング
- [ ] コミット（購入処理API連携）

### 5.4 バックエンド接続テスト
- [ ] pos-app-backend の起動確認
- [ ] Flutter アプリからの商品検索テスト
- [ ] Flutter アプリからの購入処理テスト
- [ ] エラーケースの動作確認
- [ ] コミット（バックエンド接続テスト完了）

## フェーズ6: 税金計算・表示機能

### 6.1 税金計算ロジック
- [ ] `lib/utils/tax_calculator.dart` - 税金計算ユーティリティ
- [ ] 税込・税抜金額計算
- [ ] 消費税計算
- [ ] コミット（税金計算ロジック）

### 6.2 税金表示モーダル
- [ ] `lib/widgets/tax_modal_widget.dart` - 税金表示モーダル
- [ ] 税抜金額表示
- [ ] 消費税表示
- [ ] 税込合計表示
- [ ] コミット（税金表示モーダル）

### 6.3 購入完了画面
- [ ] `lib/screens/purchase_complete_screen.dart` - 購入完了画面
- [ ] 購入成功メッセージ
- [ ] 税金情報表示
- [ ] 新規取引ボタン
- [ ] コミット（購入完了画面）

## フェーズ7: エラーハンドリング・UX改善

### 7.1 エラーハンドリング強化
- [ ] ネットワークエラーの適切な処理
- [ ] タイムアウト処理
- [ ] ユーザーフレンドリーなエラーメッセージ
- [ ] リトライ機能
- [ ] コミット（エラーハンドリング強化）

### 7.2 UX改善
- [ ] ローディング状態の表示
- [ ] 適切なフィードバック
- [ ] バリデーション機能
- [ ] キーボード操作対応
- [ ] コミット（UX改善）

### 7.3 レスポンシブデザイン
- [ ] タブレット対応
- [ ] 様々な画面サイズへの対応
- [ ] 横向き表示対応
- [ ] コミット（レスポンシブデザイン）

## フェーズ8: バーコードスキャン機能実装

### 8.1 カメラ権限設定
- [ ] `android/app/src/main/AndroidManifest.xml` - Android カメラ権限
- [ ] `ios/Runner/Info.plist` - iOS カメラ権限
- [ ] 権限要求処理の実装
- [ ] コミット（カメラ権限設定）

### 8.2 バーコードスキャンサービス
- [ ] `lib/services/barcode_service.dart` - バーコードスキャンサービス
- [ ] mobile_scanner パッケージの利用
- [ ] カメラ制御ロジック
- [ ] バーコード読み取り処理
- [ ] コミット（バーコードスキャンサービス）

### 8.3 バーコードスキャン画面
- [ ] `lib/screens/barcode_scanner_screen.dart` - バーコードスキャン画面
- [ ] カメラプレビュー表示
- [ ] 読み取り結果処理
- [ ] 手動入力への切り替え
- [ ] コミット（バーコードスキャン画面）

### 8.4 バーコードスキャン連携
- [ ] メインPOS画面からのスキャン起動
- [ ] 読み取り結果の自動商品検索
- [ ] エラーハンドリング
- [ ] コミット（バーコードスキャン連携）

## フェーズ9: テスト・品質保証

### 9.1 単体テスト
- [ ] `test/models/` - データモデルテスト
- [ ] `test/services/` - サービスクラステスト
- [ ] `test/utils/` - ユーティリティテスト
- [ ] コミット（単体テスト）

### 9.2 ウィジェットテスト
- [ ] `test/widgets/` - ウィジェットテスト
- [ ] `test/screens/` - 画面テスト
- [ ] コミット（ウィジェットテスト）

### 9.3 統合テスト
- [ ] `integration_test/` - 統合テスト
- [ ] API連携テスト
- [ ] エンドツーエンドテスト
- [ ] コミット（統合テスト）

### 9.4 パフォーマンステスト
- [ ] アプリ起動時間の測定
- [ ] メモリ使用量の確認
- [ ] バッテリー使用量の確認
- [ ] コミット（パフォーマンステスト）

## フェーズ10: デプロイメント・運用準備

### 10.1 ビルド設定
- [ ] Android リリースビルド設定
- [ ] iOS リリースビルド設定
- [ ] 署名・証明書設定
- [ ] コミット（ビルド設定）

### 10.2 アプリアイコン・スプラッシュスクリーン
- [ ] アプリアイコン作成
- [ ] スプラッシュスクリーン作成
- [ ] 各解像度対応
- [ ] コミット（アプリアイコン・スプラッシュ）

### 10.3 ドキュメント整備
- [ ] README.md の作成
- [ ] API仕様書の作成
- [ ] セットアップ手順書の作成
- [ ] コミット（ドキュメント整備）

### 10.4 最終確認
- [ ] 全機能の動作確認
- [ ] エラーケースの確認
- [ ] パフォーマンス確認
- [ ] コミット（最終確認完了）

## Git ブランチ戦略

### ブランチ構造
- `main` - 安定版・リリース用
- `develop` - 開発版統合
- `feature/*` - 機能開発用
- `hotfix/*` - 緊急修正用

### 推奨コミット規則
- **feat**: 新機能追加
- **fix**: バグ修正
- **refactor**: リファクタリング
- **test**: テスト追加・修正
- **docs**: ドキュメント更新
- **style**: コードスタイル修正

### 例: コミットメッセージ
```
feat: 商品検索ウィジェットを実装

- 商品コード入力フィールドを追加
- 検索ボタンの実装
- 商品情報表示エリアを作成
```

## 開発環境設定

### 必要な環境
- Flutter SDK (3.x以上)
- Android Studio / VS Code
- Git
- 実機またはエミュレーター

### 推奨開発フロー
1. 機能ブランチの作成
2. 実装
3. 動作確認
4. コミット・プッシュ
5. developブランチへマージ
6. 統合テスト
7. mainブランチへマージ

## 進捗管理

### 進捗状況の記録
- [ ] 完了したタスクには日付を記録
- [ ] 問題発生時はissueを作成
- [ ] 定期的な進捗レビュー

### 完了基準
- [ ] 全ての機能が正常に動作
- [ ] テストが通過
- [ ] コードレビューが完了
- [ ] ドキュメントが整備

---
**開始日**: ____/____/____
**完了予定日**: ____/____/____
**実完了日**: ____/____/____